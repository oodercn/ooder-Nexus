<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÂÅ•Â∫∑Ê£ÄÊü?- Nexus - Nexus</title>
    <link rel="stylesheet" href="/console/css/remixicon/remixicon.css">`n    <link rel="stylesheet" href="/console/css/theme.css">`n    <link rel="stylesheet" href="/console/css/dashboard.css">`n    <link rel="stylesheet" href="/console/css/styles.css">
    <link rel="stylesheet" href="/console/css/theme.css">
    <link rel="stylesheet" href="/console/css/mcpagent/common.css">
    <script src="/console/js/theme-manager.js"></script>
    <script src="/console/js/theme-manager.js"></script>`n    <script src="/console/js/menu-loader.js"></script>
    <script src="/console/js/common.js"></script>
    <script src="/console/js/nexus/base.js"></script>
    <script src="/console/js/nexus/api.js"></script>
    <script src="/console/js/nexus/ui.js"></script>
    <script src="/console/js/nexus/utils.js"></script>
    <script src="/console/js/nexus/sdk-proxy.js"></script>
    <script src="/console/js/nexus/common.js"></script>
</head>
<body class="nexus-page">
    <div class="nexus-container">
        <!-- ‰æßËæπÂØºËà™Ê†?-->
        <div class="nexus-sidebar">
            <h2 style="display: flex; align-items: center; gap: 12px;"><i class="ri-server-line"></i> Nexus Console</h2>
            <ul class="nav-menu" id="nav-menu"></ul>
        </div>
        
        <!-- ‰∏ªÂÜÖÂÆπÂå∫ -->
        <div class="nexus-main-content">
            <div class="nexus-header">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                    <h1><i class="ri-heart-pulse-line"></i> ÂÅ•Â∫∑Ê£ÄÊü?/h1>
                    <button class="theme-toggle-btn nexus-btn nexus-btn-secondary" style="padding: 8px 16px; font-size: 14px;">
                        <i class="ri-sun-line"></i> ÊµÖËâ≤Ê®°Âºè
                    </button>
                </div>
                <div class="subtitle">
                    <span class="badge dashboard-badge" style="background-color: var(--nexus-primary); color: white; padding: 4px 12px; border-radius: 12px; font-size: 12px; margin-right: 16px;">Nexus</span>
                    <span>ÁõëÊéßÂíåÊ£ÄÊü•NexusÁ≥ªÁªüÂÅ•Â∫∑Áä∂ÊÄ?/span>
                </div>
            </div>

            <!-- ÂÅ•Â∫∑Ê£ÄÊü•Êìç‰ΩúÂå∫ -->
            <section class="nexus-operation-section">
                <div class="nexus-section-header">
                    <h3>ÂÅ•Â∫∑Ê£ÄÊü•Êìç‰Ω?/h3>
                    <div class="nexus-operation-buttons">
                        <button class="nexus-btn nexus-btn-primary" onclick="runHealthCheck()">
                            <i class="ri-refresh-line"></i>
                            ËøêË°åÊ£ÄÊü?                        </button>
                        <button class="nexus-btn nexus-btn-secondary" onclick="exportHealthReport()">
                            <i class="ri-download-line"></i>
                            ÂØºÂá∫Êä•Âëä
                        </button>
                        <button class="nexus-btn nexus-btn-secondary" onclick="scheduleHealthCheck()">
                            <i class="ri-calendar-line"></i>
                            ÂÆöÊó∂Ê£ÄÊü?                        </button>
                    </div>
                </div>
                <div class="nexus-operation-card">
                    <div class="nexus-form-group">
                        <label for="checkType">Ê£ÄÊü•Á±ªÂû?/label>
                        <select id="checkType">
                            <option value="full">ÂÖ®Èù¢Ê£ÄÊü?/option>
                            <option value="quick">Âø´ÈÄüÊ£ÄÊü?/option>
                            <option value="network">ÁΩëÁªúÊ£ÄÊü?/option>
                            <option value="system">Á≥ªÁªüÊ£ÄÊü?/option>
                            <option value="services">ÊúçÂä°Ê£ÄÊü?/option>
                        </select>
                    </div>
                    <div class="nexus-form-group">
                        <label for="checkTimeout">Ë∂ÖÊó∂ËÆæÁΩÆ (Áß?</label>
                        <input type="number" id="checkTimeout" value="30" min="5" max="300">
                    </div>
                    <div class="nexus-form-group">
                        <label for="checkDetails">Ê£ÄÊü•ËØ¶ÊÉ?/label>
                        <select id="checkDetails">
                            <option value="basic">Âü∫Êú¨ËØ¶ÊÉÖ</option>
                            <option value="detailed">ËØ¶ÁªÜ‰ø°ÊÅØ</option>
                            <option value="verbose">ÂÆåÊï¥‰ø°ÊÅØ</option>
                        </select>
                    </div>
                </div>
            </section>

            <!-- Êï¥‰ΩìÂÅ•Â∫∑Áä∂ÊÄ?-->
            <section class="nexus-section">
                <div class="nexus-section-header">
                    <h3>Êï¥‰ΩìÂÅ•Â∫∑Áä∂ÊÄ?/h3>
                </div>
                <div class="nexus-card">
                    <div class="nexus-health-status">
                        <div class="nexus-health-icon">
                            <i class="ri-heart-pulse-line"></i>
                        </div>
                        <div class="nexus-health-info">
                            <h3 id="overallHealthStatus">ÂÅ•Â∫∑</h3>
                            <p id="overallHealthMessage">Á≥ªÁªüËøêË°åÊ≠£Â∏∏ÔºåÊâÄÊúâÁªÑ‰ª∂Áä∂ÊÄÅËâØÂ•?/p>
                            <div class="nexus-health-metrics">
                                <div class="nexus-stat-item">
                                    <span class="nexus-stat-label">‰∏äÊ¨°Ê£ÄÊü?</span>
                                    <span class="nexus-stat-value" id="lastCheckTime">2024-01-01 12:00:00</span>
                                </div>
                                <div class="nexus-stat-item">
                                    <span class="nexus-stat-label">Ê£ÄÊü•ËÄóÊó∂:</span>
                                    <span class="nexus-stat-value" id="checkDuration">1.2Áß?/span>
                                </div>
                                <div class="nexus-stat-item">
                                    <span class="nexus-stat-label">ÂÅ•Â∫∑ËØÑÂàÜ:</span>
                                    <span class="nexus-stat-value" id="healthScore">98/100</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ÁªÑ‰ª∂ÂÅ•Â∫∑Áä∂ÊÄ?-->
            <section class="nexus-section">
                <div class="nexus-section-header">
                    <h3>ÁªÑ‰ª∂ÂÅ•Â∫∑Áä∂ÊÄ?/h3>
                </div>
                <div class="nexus-stats-grid">
                    <div class="nexus-stats-card">
                        <div class="nexus-stats-card-header">
                            <h4>NexusÊ†∏ÂøÉ</h4>
                            <span class="nexus-status-badge nexus-status-active">ÂÅ•Â∫∑</span>
                        </div>
                        <div class="nexus-stats-card-content">
                            <p>Ê†∏ÂøÉÊúçÂä°ËøêË°åÊ≠£Â∏∏</p>
                            <div class="nexus-stat-item">
                                <span>CPU‰ΩøÁî®Áé? 12%</span>
                            </div>
                            <div class="nexus-stat-item">
                                <span>ÂÜÖÂ≠ò‰ΩøÁî®Áé? 25%</span>
                            </div>
                        </div>
                    </div>
                    <div class="nexus-stats-card">
                        <div class="nexus-stats-card-header">
                            <h4>ÁΩëÁªúÊúçÂä°</h4>
                            <span class="nexus-status-badge nexus-status-active">ÂÅ•Â∫∑</span>
                        </div>
                        <div class="nexus-stats-card-content">
                            <p>ÁΩëÁªúËøûÊé•Ê≠£Â∏∏</p>
                            <div class="nexus-stat-item">
                                <span>ËøûÊé•Êï? 12</span>
                            </div>
                            <div class="nexus-stat-item">
                                <span>‰∏¢ÂåÖÁé? 0%</span>
                            </div>
                        </div>
                    </div>
                    <div class="nexus-stats-card">
                        <div class="nexus-stats-card-header">
                            <h4>ÁªàÁ´Ø‰ª£ÁêÜ</h4>
                            <span class="nexus-status-badge nexus-status-warning">Ë≠¶Âëä</span>
                        </div>
                        <div class="nexus-stats-card-content">
                            <p>ÈÉ®ÂàÜÁªàÁ´ØÁ¶ªÁ∫ø</p>
                            <div class="nexus-stat-item">
                                <span>Ê¥ªË∑ÉÁªàÁ´Ø: 5/6</span>
                            </div>
                            <div class="nexus-stat-item">
                                <span>Á¶ªÁ∫øÁªàÁ´Ø: 1</span>
                            </div>
                        </div>
                    </div>
                    <div class="nexus-stats-card">
                        <div class="nexus-stats-card-header">
                            <h4>Â≠òÂÇ®ÊúçÂä°</h4>
                            <span class="nexus-status-badge nexus-status-active">ÂÅ•Â∫∑</span>
                        </div>
                        <div class="nexus-stats-card-content">
                            <p>Â≠òÂÇ®Áä∂ÊÄÅÊ≠£Â∏?/p>
                            <div class="nexus-stat-item">
                                <span>ÂèØÁî®Á©∫Èó¥: 85%</span>
                            </div>
                            <div class="nexus-stat-item">
                                <span>Êñá‰ª∂Á≥ªÁªü: Ê≠£Â∏∏</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Á≥ªÁªüËµÑÊ∫ê‰ΩøÁî® -->
            <section class="nexus-section">
                <div class="nexus-section-header">
                    <h3>Á≥ªÁªüËµÑÊ∫ê‰ΩøÁî®</h3>
                </div>
                <div class="nexus-card">
                    <div class="nexus-stats-grid">
                        <div class="nexus-stats-card">
                            <div class="nexus-stat-header">
                                <h4>CPU‰ΩøÁî®Áé?/h4>
                                <span id="cpuUsage">12%</span>
                            </div>
                            <div class="nexus-progress-bar">
                                <div class="nexus-progress-fill" style="width: 12%; background-color: #4CAF50;"></div>
                            </div>
                        </div>
                        <div class="nexus-stats-card">
                            <div class="nexus-stat-header">
                                <h4>ÂÜÖÂ≠ò‰ΩøÁî®Áé?/h4>
                                <span id="memoryUsage">25%</span>
                            </div>
                            <div class="nexus-progress-bar">
                                <div class="nexus-progress-fill" style="width: 25%; background-color: #2196F3;"></div>
                            </div>
                        </div>
                        <div class="nexus-stats-card">
                            <div class="nexus-stat-header">
                                <h4>Á£ÅÁõò‰ΩøÁî®Áé?/h4>
                                <span id="diskUsage">15%</span>
                            </div>
                            <div class="nexus-progress-bar">
                                <div class="nexus-progress-fill" style="width: 15%; background-color: #FFC107;"></div>
                            </div>
                        </div>
                        <div class="nexus-stats-card">
                            <div class="nexus-stat-header">
                                <h4>ÁΩëÁªúÂ∏¶ÂÆΩ</h4>
                                <span id="networkUsage">10Mbps</span>
                            </div>
                            <div class="nexus-progress-bar">
                                <div class="nexus-progress-fill" style="width: 10%; background-color: #9C27B0;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ÊúçÂä°Áä∂ÊÄ?-->
            <section class="nexus-section">
                <div class="nexus-section-header">
                    <h3>ÊúçÂä°Áä∂ÊÄ?/h3>
                </div>
                <div class="nexus-card">
                    <table class="nexus-data-table">
                        <thead>
                            <tr>
                                <th>ÊúçÂä°ÂêçÁß∞</th>
                                <th>Áä∂ÊÄ?/th>
                                <th>Á´ØÂè£</th>
                                <th>ÂêØÂä®Êó∂Èó¥</th>
                                <th>ÂìçÂ∫îÊó∂Èó¥</th>
                                <th>Êìç‰Ωú</th>
                            </tr>
                        </thead>
                        <tbody id="serviceTableBody">
                            <!-- ÊúçÂä°Êï∞ÊçÆÂ∞ÜÈÄöËøáJSÂä®ÊÄÅÂ°´ÂÖ?-->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- ÂÅ•Â∫∑Ê£ÄÊü•Êó•Âø?-->
            <section class="nexus-section">
                <div class="nexus-section-header">
                    <h3>ÂÅ•Â∫∑Ê£ÄÊü•Êó•Âø?/h3>
                </div>
                <div class="nexus-card">
                    <div class="nexus-log-container" id="healthLogContainer">
                        <!-- Êó•ÂøóÊï∞ÊçÆÂ∞ÜÈÄöËøáJSÂä®ÊÄÅÂ°´ÂÖ?-->
                    </div>
                </div>
            </section>
        </div>
    </div>

    <script>
        window.onPageInit = function() {
            // ÂàùÂßãÂåñÈ°µÈù?            nexusCommon.initPage('health-check', loadHealthData);
        };

        // Ê®°ÊãüÂÅ•Â∫∑Ê£ÄÊü•Êï∞Êç?        let healthData = {
            overall: {
                status: "healthy",
                message: "Á≥ªÁªüËøêË°åÊ≠£Â∏∏ÔºåÊâÄÊúâÁªÑ‰ª∂Áä∂ÊÄÅËâØÂ•?,
                score: 98,
                lastCheck: new Date().toISOString(),
                duration: 1.2
            },
            components: [
                {
                    name: "NexusÊ†∏ÂøÉ",
                    status: "healthy",
                    message: "Ê†∏ÂøÉÊúçÂä°ËøêË°åÊ≠£Â∏∏",
                    metrics: {
                        cpu: 12,
                        memory: 25
                    }
                },
                {
                    name: "ÁΩëÁªúÊúçÂä°",
                    status: "healthy",
                    message: "ÁΩëÁªúËøûÊé•Ê≠£Â∏∏",
                    metrics: {
                        connections: 12,
                        packetLoss: 0
                    }
                },
                {
                    name: "ÁªàÁ´Ø‰ª£ÁêÜ",
                    status: "warning",
                    message: "ÈÉ®ÂàÜÁªàÁ´ØÁ¶ªÁ∫ø",
                    metrics: {
                        activeEndpoints: 5,
                        totalEndpoints: 6,
                        offlineEndpoints: 1
                    }
                },
                {
                    name: "Â≠òÂÇ®ÊúçÂä°",
                    status: "healthy",
                    message: "Â≠òÂÇ®Áä∂ÊÄÅÊ≠£Â∏?,
                    metrics: {
                        freeSpace: 85,
                        filesystem: "Ê≠£Â∏∏"
                    }
                }
            ],
            resources: {
                cpu: 12,
                memory: 25,
                disk: 15,
                network: 10
            },
            services: [
                {
                    name: "Nexus Service",
                    status: "running",
                    port: 9876,
                    startTime: new Date(Date.now() - 3600000).toISOString(),
                    responseTime: 15
                },
                {
                    name: "Web Console",
                    status: "running",
                    port: 8080,
                    startTime: new Date(Date.now() - 3600000).toISOString(),
                    responseTime: 20
                },
                {
                    name: "API Service",
                    status: "running",
                    port: 8081,
                    startTime: new Date(Date.now() - 3600000).toISOString(),
                    responseTime: 10
                },
                {
                    name: "Monitoring Service",
                    status: "running",
                    port: 9090,
                    startTime: new Date(Date.now() - 3600000).toISOString(),
                    responseTime: 5
                }
            ],
            logs: [
                {
                    timestamp: new Date(Date.now() - 300000).toISOString(),
                    level: "INFO",
                    message: "ÂÅ•Â∫∑Ê£ÄÊü•ÂÆåÊà? Á≥ªÁªüÁä∂ÊÄÅËâØÂ•?
                },
                {
                    timestamp: new Date(Date.now() - 600000).toISOString(),
                    level: "INFO",
                    message: "ÁΩëÁªúÊ£ÄÊü•ÂÆåÊà? ÊâÄÊúâËøûÊé•Ê≠£Â∏?
                },
                {
                    timestamp: new Date(Date.now() - 900000).toISOString(),
                    level: "WARNING",
                    message: "ÁªàÁ´Ø‰ª£ÁêÜÊ£ÄÊü? 1‰∏™ÁªàÁ´ØÁ¶ªÁ∫?
                },
                {
                    timestamp: new Date(Date.now() - 1200000).toISOString(),
                    level: "INFO",
                    message: "ÊúçÂä°Ê£ÄÊü•ÂÆåÊà? ÊâÄÊúâÊúçÂä°ËøêË°åÊ≠£Â∏?
                }
            ]
        };

        function loadHealthData() {
            updateOverallHealth();
            updateServiceStatus();
            updateHealthLogs();
        }

        function updateOverallHealth() {
            document.getElementById('overallHealthStatus').textContent = healthData.overall.status === 'healthy' ? 'ÂÅ•Â∫∑' : 'ÂºÇÂ∏∏';
            document.getElementById('overallHealthMessage').textContent = healthData.overall.message;
            document.getElementById('lastCheckTime').textContent = nexusCommon.formatTimestamp(new Date(healthData.overall.lastCheck).getTime());
            document.getElementById('checkDuration').textContent = healthData.overall.duration + 'Áß?;
            document.getElementById('healthScore').textContent = healthData.overall.score + '/100';
            document.getElementById('cpuUsage').textContent = healthData.resources.cpu + '%';
            document.getElementById('memoryUsage').textContent = healthData.resources.memory + '%';
            document.getElementById('diskUsage').textContent = healthData.resources.disk + '%';
            document.getElementById('networkUsage').textContent = healthData.resources.network + 'Mbps';
        }

        function updateServiceStatus() {
            const tbody = document.getElementById('serviceTableBody');
            tbody.innerHTML = '';

            healthData.services.forEach(service => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${service.name}</td>
                    <td><span class="nexus-status-badge ${service.status === 'running' ? 'nexus-status-active' : 'nexus-status-inactive'}">${service.status === 'running' ? 'ËøêË°å‰∏? : 'ÂÅúÊ≠¢'}</span></td>
                    <td>${service.port}</td>
                    <td>${nexusCommon.formatTimestamp(new Date(service.startTime).getTime())}</td>
                    <td>${service.responseTime}ms</td>
                    <td>
                        <button class="nexus-btn nexus-btn-sm nexus-btn-primary" onclick="restartService('${service.name}')">ÈáçÂêØ</button>
                        <button class="nexus-btn nexus-btn-sm nexus-btn-secondary" onclick="checkService('${service.name}')">Ê£ÄÊü?/button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateHealthLogs() {
            const logContainer = document.getElementById('healthLogContainer');
            logContainer.innerHTML = '';

            healthData.logs.forEach(log => {
                const logItem = document.createElement('div');
                logItem.className = 'nexus-log-item ' + log.level.toLowerCase();
                logItem.innerHTML = `
                    <div class="nexus-log-header">
                        <span class="nexus-log-timestamp">${nexusCommon.formatTimestamp(new Date(log.timestamp).getTime())}</span>
                        <span class="nexus-log-level ${log.level.toLowerCase()}">${log.level}</span>
                    </div>
                    <div class="nexus-log-message">${log.message}</div>
                `;
                logContainer.appendChild(logItem);
            });
        }

        async function runHealthCheck() {
            try {
                const checkType = document.getElementById('checkType').value;
                const checkTimeout = document.getElementById('checkTimeout').value;
                const checkDetails = document.getElementById('checkDetails').value;

                // Ê®°ÊãüÂÅ•Â∫∑Ê£ÄÊü?                nexusCommon.showMessage('ÂºÄÂßãÂÅ•Â∫∑Ê£ÄÊü?..', 'info');
                
                setTimeout(() => {
                    // Êõ¥Êñ∞ÂÅ•Â∫∑Ê£ÄÊü•Êï∞Êç?                    healthData.overall.lastCheck = new Date().toISOString();
                    healthData.overall.duration = Math.random() * 2 + 0.5;
                    healthData.overall.score = Math.floor(Math.random() * 5) + 95;
                    
                    // Ê∑ªÂä†Êñ∞ÁöÑÊó•ÂøóÊù°ÁõÆ
                    const newLog = {
                        timestamp: new Date().toISOString(),
                        level: "INFO",
                        message: `ÂÅ•Â∫∑Ê£ÄÊü•ÂÆåÊà?(${getCheckTypeName(checkType)}): Á≥ªÁªüÁä∂ÊÄ?{healthData.overall.score > 90 ? 'ËâØÂ•Ω' : 'Ê≠£Â∏∏'}`
                    };
                    healthData.logs.unshift(newLog);
                    if (healthData.logs.length > 10) {
                        healthData.logs.pop();
                    }
                    
                    // Êõ¥Êñ∞È°µÈù¢
                    updateOverallHealth();
                    updateHealthLogs();
                    
                    nexusCommon.showMessage('ÂÅ•Â∫∑Ê£ÄÊü•ÂÆåÊà?, 'success');
                }, 1500);
            } catch (error) {
                nexusCommon.handleApiError(error, 'ÂÅ•Â∫∑Ê£ÄÊü•Â§±Ë¥?);
            }
        }

        function exportHealthReport() {
            try {
                // Ê®°ÊãüÂØºÂá∫ÂÅ•Â∫∑Êä•Âëä
                const reportData = JSON.stringify(healthData, null, 2);
                const blob = new Blob([reportData], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'health-report-' + new Date().toISOString().slice(0, 10) + '.json';
                a.click();
                URL.revokeObjectURL(url);
                nexusCommon.showMessage('ÂÅ•Â∫∑Êä•ÂëäÂ∑≤ÂØºÂá?, 'success');
            } catch (error) {
                nexusCommon.handleApiError(error, 'ÂØºÂá∫ÂÅ•Â∫∑Êä•ÂëäÂ§±Ë¥•');
            }
        }

        function scheduleHealthCheck() {
            // Ê®°ÊãüÂÆöÊó∂Ê£ÄÊü•ËÆæÁΩ?            nexusCommon.showMessage('ÂÆöÊó∂Ê£ÄÊü•ÂäüËÉΩÂ∑≤ËÆæÁΩÆ', 'success');
        }

        function restartService(serviceName) {
            try {
                // Ê®°ÊãüÈáçÂêØÊúçÂä°
                nexusCommon.showMessage(`ÊúçÂä° ${serviceName} ÈáçÂêØ‰∏?..`, 'info');
                setTimeout(() => {
                    nexusCommon.showMessage(`ÊúçÂä° ${serviceName} ÈáçÂêØÊàêÂäü`, 'success');
                }, 2000);
            } catch (error) {
                nexusCommon.handleApiError(error, `ÈáçÂêØÊúçÂä° ${serviceName} Â§±Ë¥•`);
            }
        }

        function checkService(serviceName) {
            try {
                // Ê®°ÊãüÊ£ÄÊü•ÊúçÂä?                nexusCommon.showMessage(`Ê£ÄÊü•ÊúçÂä?${serviceName}...`, 'info');
                setTimeout(() => {
                    nexusCommon.showMessage(`ÊúçÂä° ${serviceName} Áä∂ÊÄÅÊ≠£Â∏∏`, 'success');
                }, 1000);
            } catch (error) {
                nexusCommon.handleApiError(error, `Ê£ÄÊü•ÊúçÂä?${serviceName} Â§±Ë¥•`);
            }
        }

        function getCheckTypeName(checkType) {
            const typeMap = {
                'full': 'ÂÖ®Èù¢Ê£ÄÊü?,
                'quick': 'Âø´ÈÄüÊ£ÄÊü?,
                'network': 'ÁΩëÁªúÊ£ÄÊü?,
                'system': 'Á≥ªÁªüÊ£ÄÊü?,
                'services': 'ÊúçÂä°Ê£ÄÊü?
            };
            return typeMap[checkType] || checkType;
        }
    </script>
</body>
</html>
